<app-header title="–î–æ–±–∞–≤–∏—Ç—å –∫–∞—Ä—Ç—É" [showBackButton]="true" />

<div class="add-card-page">
  <form [formGroup]="cardForm" class="form" (ngSubmit)="onSubmit()">
    <div class="form-content">
      <div class="form-group">
        <label class="label" for="cardName">
          –ù–∞–∑–≤–∞–Ω–∏–µ –∫–∞—Ä—Ç—ã
          <span class="required">*</span>
        </label>
        <input
          type="text"
          id="cardName"
          class="input"
          [class.error]="hasError('cardName')"
          placeholder="–Ω–∞–ø—Ä–∏–º–µ—Ä, –†–∞–±–æ—á–∞—è –∫–∞—Ä—Ç–∞ –∏–ª–∏ –û—Å–Ω–æ–≤–Ω–∞—è –í–∏–∑–∞"
          formControlName="cardName"
          [attr.aria-invalid]="hasError('cardName')"
          [attr.aria-describedby]="hasError('cardName') ? 'cardName-error' : null"
        />
        @if (hasError('cardName')) {
          <span id="cardName-error" class="error-message" role="alert">
            {{ getErrorMessage('cardName') }}
          </span>
        }
      </div>

      <div class="form-group">
        <label class="label" for="lastDigits">
          –ü–æ—Å–ª–µ–¥–Ω–∏–µ 4 —Ü–∏—Ñ—Ä—ã
          <span class="required">*</span>
        </label>
        <input
          type="text"
          id="lastDigits"
          class="input"
          [class.error]="hasError('lastDigits')"
          placeholder="0000"
          formControlName="lastDigits"
          (input)="onLastDigitsInput($event)"
          maxlength="4"
          inputmode="numeric"
          [attr.aria-invalid]="hasError('lastDigits')"
          [attr.aria-describedby]="hasError('lastDigits') ? 'lastDigits-error' : null"
        />
        @if (hasError('lastDigits')) {
          <span id="lastDigits-error" class="error-message" role="alert">
            {{ getErrorMessage('lastDigits') }}
          </span>
        }
      </div>

      <app-color-picker
        [selectedColor]="selectedColor()"
        (colorSelected)="onColorSelected($event)"
      />

      <app-card-type-selector
        [selectedType]="selectedType()"
        (typeSelected)="onTypeSelected($event)"
      />
    </div>

    <div class="actions">
      <button
        type="submit"
        class="btn btn-primary"
        [disabled]="!isFormValid()"
        [attr.aria-busy]="isSubmitting()"
      >
        @if (isSubmitting()) {
          <span class="spinner" aria-hidden="true"></span>
          <span>–î–æ–±–∞–≤–ª–µ–Ω–∏–µ...</span>
        } @else {
          <span class="icon" aria-hidden="true">üí≥</span>
          <span>–î–æ–±–∞–≤–∏—Ç—å –∫–∞—Ä—Ç—É</span>
        }
      </button>
      <button
        type="button"
        class="btn btn-secondary"
        (click)="onCancel()"
        [disabled]="isSubmitting()"
      >
        –û—Ç–º–µ–Ω–∞
      </button>
    </div>
  </form>
</div>
